<!DOCTYPE html>
<html lang="zh-cn">
        <head>
      <meta charset="utf-8"/>
      <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
      <title>Mac上使用homebrew安装PostgreSql - JavaChen Blog</title>
      <meta name="author" content="yuke"/>
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
      <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
      <link rel="canonical" href="http://blog.javachen.com/2014/10/30/install-postgresql-on-mac-using-homebrew.html" />

      <link rel="stylesheet" href="/static/contrib/bootstrap/css/bootstrap.min.css" media="all" />
      <link rel="stylesheet" href="/static/css/style.css" media="all" />
      <link rel="stylesheet" href="/static/css/pygments.css" media="all" />
      <link rel="stylesheet" href="/static/contrib/font-awesome/css/font-awesome.min.css" media="all" />
      <link rel="stylesheet" type="text/css" href="/static/contrib/showup/showup.css" />

      <!-- atom & rss feed -->
      <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="JavaChen Blog RSS Feed" />
      <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="JavaChen Blog ATOM Feed" />

        <!-- fav and touch icons  -->
        <!-- Update these with your own images
        <link rel="shortcut icon" href="images/favicon.ico">
        <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
        <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
        -->

      <meta name="renderer" content="webkit|ie-stand">
      <meta name="baidu-site-verification" content="3HAhaWRiyR" />
      <meta name="360-site-verification" content="9b7a87a1d52051c96644f0a9b8b79898" />
      <meta name="sogou_site_verification" content="ofwXWFdthV"/>
      <meta property="wb:webmaster" content="b6081b2b8ab84c60" />
    </head>

    <body>
      <!--[if lte IE 9]>
<div class="alert alert-warning">
  <p>Your Internet Explorer is not supported. Please upgrade your Internet Explorer to version 9+, or use latest <a href="http://www.google.com/chrome/" target="_blank" class="alert-link">Google chrome</a>、<a href="http://www.mozilla.org/firefox/" target="_blank" class="alert-link">Mozilla Firefox</a>.</p>
  <p>If you are using IE 9 or later, make sure you <a href="http://windows.microsoft.com/en-us/internet-explorer/use-compatibility-view#ie=ie-8" target="_blank" class="alert-link">turn off "Compatibility view"</a>.</p>
</div>
<![endif]-->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">JavaChen Blog</a>
        </div>
        <div class="navbar-collapse collapse">
            <form id="search-form" class="form-group navbar-form navbar-right" role="search">
                  <div class="form-group">
                    <input type="text" name="q" value=""  id="query" class="form-control" placeholder="搜索" required autocomplete="off" ></input>
                    <input type="submit" class="btn btn-default" value=" Go" ></input>
                  </div>
              </form>
            <ul class="nav navbar-nav">
              <li><a href="/archive.html" title="Archive"><span class='fa fa-archive fa-2x'></span></a></li>
              <li><a href="/categories.html" title="Categories"><span class='fa fa-navicon fa-2x'></span></a></li>
              <li><a href="/tags.html" title="Tags"><span class='fa fa-tags fa-2x'></span></a></li>
              <li><a href="/about.html" title="About"><span class='fa fa-user fa-2x'></span></a></li>
              
              <li><a href="https://github.com/javachen" target="_blank" title="Github"><span class='fa fa-github fa-2x'></span></a></li>
              
              
              
              <li><a href="https://twitter.com/java_chen" target="_blank" title="twitter"><span class="fa fa-twitter fa-2x"></span></a></li>
              
              
              
              <li><a href="http://weibo.com/chenzhijun" target="_blank" title="Weibo"><span class="fa fa-weibo fa-2x"></span></a></li>
              
              <li><a href="/rss.xml" target="_blank" title="RSS"><span class='fa fa-rss fa-2x'></span></a></li>
            </ul>
        </div>

        </div><!--/.nav-collapse -->
      </div>
</div>

      <div id="wrap">
          <div class="container">
                 <div id="content">
          <ul class="pager hidden-print">
               
                <li class="previous"><a href="/2014/10/30/django-template.html" title="Django中的模板"><i class="fa fa-angle-double-left"></i>&nbsp;Django中的模板</a></li>
                
                
                <li class="next"><a href="/2014/11/04/config-kerberos-in-cdh-hdfs.html" title="HDFS配置Kerberos认证">HDFS配置Kerberos认证&nbsp;<i class="fa fa-angle-double-right"></i></a></li>
                
          </ul>

           <div id="post" class="clearfix">
              <div id="post-title" class="page-header text-center">
                  <h1> Mac上使用homebrew安装PostgreSql  </h1>
              </div>
              <p class="text-muted clearfix">
                  <span class="pull-right">2014.10.30 | <a href="#comments">Comments</a></span>
              </p>
              <div id="qr" class="qrcode visible-lg"></div>

              <div id="post-text">
                    <h1 id="安装">安装</h1>

<p>brew 安装 postgresql ：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>brew install postgresql
</code></pre></div>
<p>查看安装的版本：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>pg_ctl -V
pg_ctl <span class="o">(</span>PostgreSQL<span class="o">)</span> 9.3.5
</code></pre></div>
<p>安装成功之后，安装路径为：/usr/local/var/postgres</p>

<p>接下来，初始化数据库：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>initdb /usr/local/var/postgres
The files belonging to this database system will be owned by user <span class="s2">&quot;june&quot;</span>.
This user must also own the server process.

The database cluster will be initialized with locale <span class="s2">&quot;zh_CN.UTF-8&quot;</span>.
The default database encoding has accordingly been <span class="nb">set </span>to <span class="s2">&quot;UTF8&quot;</span>.
initdb: could not find suitable text search configuration <span class="k">for</span> locale <span class="s2">&quot;zh_CN.UTF-8&quot;</span>
The default text search configuration will be <span class="nb">set </span>to <span class="s2">&quot;simple&quot;</span>.

Data page checksums are disabled.

creating directory /usr/local/var/postgres ... ok
creating subdirectories ... ok
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
creating configuration files ... ok
creating template1 database in /usr/local/var/postgres/base/1 ... ok
initializing pg_authid ... ok
initializing dependencies ... ok
creating system views ... ok
loading system objects<span class="err">&#39;</span> descriptions ... ok
creating collations ... ok
creating conversions ... ok
creating dictionaries ... ok
setting privileges on built-in objects ... ok
creating information schema ... ok
loading PL/pgSQL server-side language ... ok
vacuuming database template1 ... ok
copying template1 to template0 ... ok
copying template1 to postgres ... ok
syncing data to disk ... ok

WARNING: enabling <span class="s2">&quot;trust&quot;</span> authentication <span class="k">for</span> <span class="nb">local </span>connections
You can change this by editing pg_hba.conf or using the option -A, or
--auth-local and --auth-host, the next <span class="nb">time </span>you run initdb.

Success. You can now start the database server using:

    postgres -D /usr/local/var/postgres
or
    pg_ctl -D /usr/local/var/postgres -l logfile start
</code></pre></div>
<p>配置开机登陆（可选）：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>mkdir -p ~/Library/LaunchAgents
<span class="nv">$ </span>cp /usr/local/Cellar/postgresql/9.3.5_1/homebrew.mxcl.postgresql.plist ~/Library/LaunchAgents/
<span class="nv">$ </span>launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist
</code></pre></div>
<p>手动启动 postgresql</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>pg_ctl -D /usr/local/var/postgres -l /usr/local/var/postgres/server.log start
</code></pre></div>
<p>查看状态：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">pg_ctl -D /usr/local/var/postgres -l /usr/local/var/postgres/server.log status
</code></pre></div>
<p>停止：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>pg_ctl -D /usr/local/var/postgres -l /usr/local/var/postgres/server.log stop -s -m fast
</code></pre></div>
<p>查看进程：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>ps auxwww <span class="p">|</span> grep postgres
june            <span class="m">56126</span>   0.0  0.0  <span class="m">2432772</span>    <span class="m">644</span> s000  S+    5:01下午   0:00.00 grep postgres
june            <span class="m">56058</span>   0.0  0.0  <span class="m">2467360</span>    <span class="m">584</span>   ??  Ss    5:00下午   0:00.00 postgres: stats collector process
june            <span class="m">56057</span>   0.0  0.0  <span class="m">2611808</span>   <span class="m">1744</span>   ??  Ss    5:00下午   0:00.00 postgres: autovacuum launcher process
june            <span class="m">56056</span>   0.0  0.0  <span class="m">2611676</span>    <span class="m">696</span>   ??  Ss    5:00下午   0:00.00 postgres: wal writer process
june            <span class="m">56055</span>   0.0  0.0  <span class="m">2611676</span>    <span class="m">944</span>   ??  Ss    5:00下午   0:00.01 postgres: writer process
june            <span class="m">56054</span>   0.0  0.0  <span class="m">2611676</span>    <span class="m">756</span>   ??  Ss    5:00下午   0:00.00 postgres: checkpointer process
june            <span class="m">56044</span>   0.0  0.2  <span class="m">2611676</span>  <span class="m">14096</span> s000  S     5:00下午   0:00.02 /usr/local/Cellar/postgresql/9.3.5_1/bin/postgres -D /usr/local/var/postgres
</code></pre></div>
<p>创建用户和数据库：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#createuser will prompt you for a password, enter it twice.</span>
<span class="nv">$ </span>createuser  -P <span class="nb">test</span>
<span class="nv">$ </span>createdb -Otest -Eutf8 test_db
<span class="nv">$ </span>psql
<span class="nv">postgres</span><span class="o">=</span><span class="c"># GRANT ALL PRIVILEGES ON test TO test;</span>
<span class="nv">postgres</span><span class="o">=</span><span class="c"># \q</span>
</code></pre></div>
<p>进入命令行模式：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>psql -U <span class="nb">test </span>test_db -h localhost -W
</code></pre></div>
<p>如果出现 <code class="prettyprint">FATAL: Ident authentication failed for user</code>，是因为：</p>

<blockquote>
<p>This is because by default PostgreSQL uses ‘ident’ authentication i.e it checks if the username exists on the system. You need to change authentication mode to ‘trust’ as we do not want to add a system user.
Modify the settings in &quot;pg_hba.conf&quot; to use &#39;trust&#39; authentication.</p>
</blockquote>

<p>请修改 /usr/local/var/postgres/pg_hba.conf 为：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">host    all             all             127.0.0.1/32            trust
# IPv6 local connections:
host    all             all             ::1/128                 trust
</code></pre></div>
<p>安装 pgadmin，下载地址：<a href="http://www.pgadmin.org/download/macosx.php">http://www.pgadmin.org/download/macosx.php</a></p>

<h1 id="卸载">卸载</h1>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>brew uninstall postgres
</code></pre></div>
<p>如果配置了开机登陆：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist
<span class="nv">$ </span>rm -rf ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist
</code></pre></div>
                    <br/>
                    <div class="well">
                        原创文章，转载请注明： 转载自<a href="http://blog.javachen.com">JavaChen Blog</a>，作者：<a href="http://blog.javachen.com/about.html">yuke</a><br/>
                        本文链接地址：<a href="/2014/10/30/install-postgresql-on-mac-using-homebrew.html">http://blog.javachen.com/2014/10/30/install-postgresql-on-mac-using-homebrew.html</a><br/>
                        本文基于<a target="_blank" title="Creative Commons Attribution 2.5 China Mainland License" href="http://creativecommons.org/licenses/by/2.5/cn/">署名2.5中国大陆许可协议</a>发布，欢迎转载、演绎或用于商业目的，但是必须保留本文署名和文章链接。
                        如您有任何疑问或者授权方面的协商，请邮件联系我</a>。
                    </div>
                    <div class="col-md-6">
                      <p class="text-success hidden-print"><i class="fa fa-external-link"></i> <a href="/2014/10/30/install-postgresql-on-mac-using-homebrew.html">Mac上使用homebrew安装PostgreSql</a></p>
                    </div>
                    <div class="col-md-6">
                       <p class="meta hidden-print pull-right">
                        
                            <i class="fa fa-folder-open"></i>
                            
                            <a class="btn btn-default btn-sm" href="/categories.html#database">database</a>
                          
                        
                        
                            <i class="fa fa-tags"></i>
                            
                            <a class="btn btn-default btn-sm" href="/tags.html#postgresql">postgresql</a>
                          
                        </p>
                    </div>
               </div><!--#post-text-->
          </div><!--#post-->
      </div> <!--#content-->

      <div id="post-comment" class="hidden-print">
      
<div id="comments">
  <div class="ds-thread" data-thread-key="/2014/10/30/install-postgresql-on-mac-using-homebrew.html" data-url="http://blog.javachen.com/2014/10/30/install-postgresql-on-mac-using-homebrew.html" data-title="Mac上使用homebrew安装PostgreSql"></div>
</div>



      </div>


          </div>
          <a href="#" class="btn back-to-top btn-dark btn-fixed-bottom hidden-print"><i class="fa fa-chevron-up"></i></a>
      </div>
      <div id="footer">
          <div class="container hidden-print">
              <p class="text-center"><i class="fa fa-copyright"></i> 2015 JavaChen Blog. Theme designed by <a href="/about.html" target="_blank" title="">yuke</a> with <a href="https://github.com/mojombo/jekyll/">Jekyll</a>, <a href="http://twitter.github.com/bootstrap/">Bootstrap</a> and <a href="http://fortawesome.github.com/Font-Awesome/">Font Awesome</a>.
  	            
            <script type="text/javascript">
                var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
                document.write(unescape("%3Cspan id='cnzz_stat_icon_1256628929'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/z_stat.php%3Fid%3D1256628929' type='text/javascript'%3E%3C/script%3E"));</script>
            
            
    </p>
          </div>
      </div>

      <script type="text/javascript" src="/static/contrib/jquery/jquery.min.js"></script>
      <script type="text/javascript" src="/static/contrib/bootstrap/js/bootstrap.min.js"></script>
      <script type="text/javascript" src="/static/contrib/qrcode/jquery.qrcode.min.js"></script>
      <script type="text/javascript" src="/static/contrib/showup/showup.js"></script>
      <script type="text/javascript" src="/static/js/core.js"></script>
      
      <script type="text/javascript">
      var duoshuoQuery = {short_name:"javachen"};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = 'http://static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] ||
        document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
      

      <script type="text/javascript">
      $('#qr').qrcode({
          width: 128,
          height: 128,
          text: 'http://blog.javachen.com/2014/10/30/install-postgresql-on-mac-using-homebrew.html'
      });
      </script>
  </body>
</html>
